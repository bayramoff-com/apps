<div class="container">
  <div class="content is-large">
    <h2 class="has-text-weight-bold">JSON DEBUGGER</h2>
    <div class="columns ">
      <div class="column">

        <div class="block">
          <textarea class="textarea is-primary" id="input"
            placeholder="10 lines of textarea" rows="20"></textarea>
        </div>

        <div class="block">
          <a onclick="getJson()" class="button">
            VALIDATE JSON
          </a>
        </div>

        <article id="message" class="message is-invisible">
          <div class="message-body is-size-4" id="message_body">
          </div>
        </article>

      </div>
      <div class="column">

        <div class="block">
          <textarea class="textarea is-info" id="result" readonly
            readonly="readonly" placeholder="json" rows="20"></textarea>
        </div>
      </div>
    </div>
  </div>

</div>

<script>
  function getJson() {
      var input = document.getElementById("input").value;
      input = input.trim();

      try {
          var jsonPretty = JSON.stringify(JSON.parse(input), null, "\t");
          document.getElementById("result").innerHTML = jsonPretty;
          document.getElementById("message_body").innerHTML = "Valid JSON";
          document.getElementById("message").classList.remove("is-invisible");
          document.getElementById("message").classList.remove("is-danger");
          document.getElementById("message").classList.remove("is-info");

          document.getElementById("message").classList.add("is-info");
      } catch (error) { 
          document.getElementById("result").innerHTML = "";
          document.getElementById("message_body").innerHTML = error;
          document.getElementById("message").classList.remove("is-invisible");
          document.getElementById("message").classList.remove("is-danger");
          document.getElementById("message").classList.remove("is-info");

          document.getElementById("message").classList.add("is-danger");
          var errormessage = String(error);
          let check = errormessage.includes("at position");
          if (check == true) {
              var position = errormessage.split(' ').pop();

              var start_position = Number(position) - 20;
              var end_position = Number(position) + 20;

              var first_half = input.substring(start_position, position);
              var second_half = input.substring(position, end_position);

              var output = first_half + '<span class="has-background-warning is-size-2">Â¶</span>' + second_half;

              document.getElementById("message_body").innerHTML += "<hr>";
              document.getElementById("message_body").innerHTML += output;

          }

      }




  }
</script>
